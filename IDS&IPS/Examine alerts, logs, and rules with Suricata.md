## Task 1. Examine a custom rule in Suricata
The /home/analyst directory contains a custom.rules file that defines the network traffic rules, which Suricata captures.

In this task, you’ll explore the composition of the Suricata rule defined in the custom.rules file.

![Screenshot 2024-08-19 224639](https://github.com/user-attachments/assets/11cbbcc3-5159-4815-afe8-b0baa3a788d2)

## Action
![Screenshot 2024-08-19 225244](https://github.com/user-attachments/assets/bb6a8ae4-456b-4e08-9e63-6474b6915e72)

The action represents the first component of the signature, dictating what to do when all specified conditions are met.

While actions vary across different network intrusion detection system (NIDS) rule languages, common ones include alert, drop, pass, and reject.

In our example, the file specifies a single alert as the action. The alert keyword signals the system to monitor selected network traffic and issue an alert if a match is found.

It’s important to note that the drop action also triggers an alert but additionally drops the traffic. This action is only executed when Suricata operates in IPS mode.

The pass action permits the traffic to flow through the network interface. This rule can also be employed to override other existing rules.

## Header

![Screenshot 2024-08-19 225553](https://github.com/user-attachments/assets/357ea838-ef10-4579-ab35-5b9f3c89909a)

The next component of the signature is the header. The header specifies the characteristics of the network traffic, including attributes such as protocols, source and destination IP addresses, source and destination ports, and traffic direction.

Following the action keyword is the protocol field. In our example, the protocol is HTTP, indicating that the rule is applicable solely to HTTP traffic.

The parameters for the HTTP protocol field are $HOME_NET any -> $EXTERNAL_NET any. The arrow signifies the traffic flow, originating from $HOME_NET and directed toward the destination IP address $EXTERNAL_NET.

## Rule

![Screenshot 2024-08-19 225844](https://github.com/user-attachments/assets/a583dd15-756a-4898-bef0-ce0e7d8008f5)

The wide range of rule options allows you to customize signatures with specific parameters. By fine-tuning these rule options, you can filter network traffic more precisely to locate exactly what you need. In our example, rule options are typically placed within parentheses and separated by semicolons.

## Task 2. Trigger a custom rule in Suricata
List the files in the /var/log/suricata folder:

![Screenshot 2024-08-19 230507](https://github.com/user-attachments/assets/0219e42c-6a3e-49e5-b555-9fefcf30c3a1)

Run suricata using the custom.rules and sample.pcap files:
![Screenshot 2024-08-19 230723](https://github.com/user-attachments/assets/cdcd2ca5-21a1-4b51-90dc-67bfc4202366)

List the files in the /var/log/suricata folder again:

![Screenshot 2024-08-19 230821](https://github.com/user-attachments/assets/1901708b-b2dd-4cba-882c-2ea803965012)

Use the cat command to display the fast.log file generated by Suricata:

![Screenshot 2024-08-19 230935](https://github.com/user-attachments/assets/4ca2c0e2-2bac-4e57-b5e9-2927566ae1fd)

## Task 3. Examine eve.json output

Use the cat command to display the entries in the eve.json file:

![Screenshot 2024-08-19 231346](https://github.com/user-attachments/assets/d3c8fe9f-fb15-4e77-ad5f-0dcbea4d9e89)

Use the jq command to display the entries in an improved format:

![Screenshot 2024-08-19 231614](https://github.com/user-attachments/assets/40ce89c4-1336-49c5-8d82-4b6569d4f703)

What is the value of the severity property for the first alert returned by the jq command?
#### Answer:3

Use the jq command to extract specific event data from the eve.json file:

![Screenshot 2024-08-19 232246](https://github.com/user-attachments/assets/8b9fc746-587e-4b7b-82ee-4efa508a4b75)

What is the destination IP address listed for the last event in the 'eve.json' file

#### Answer: 142.250.1.102

What is the alert signature for the first alert entry in the 'eve.json' file?

#### Answer: GET on wire

